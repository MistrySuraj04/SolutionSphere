# Question 2119: Most Lucrative Products

**Platform:** StrataScratch

**Difficulty:** Easy

**Problem Statement**

You have been asked to find the 5 most lucrative products in terms of total revenue
for the first half of 2022 (from January to June inclusive).
Output their IDs and the total revenue.

### Table Structure

Table: online_orders

product_id:         int
promotion_id:       int
cost_in_dollars:    int
customer_id:        int
date:               datetime
units_sold:         int

### Solution Query

SELECT A.*
FROM (
    SELECT product_id, SUM((cost_in_dollars) * units_sold) AS revenue
    FROM online_orders
    WHERE date BETWEEN '2022-01-01' AND '2022-06-30'
    GROUP BY product_id
) AS A
ORDER BY revenue DESC
LIMIT 5;

### Explanation

- **Purpose**: Retrieves the top 5 products by total revenue from online orders within the first half of 2022.
- **Selected Columns**:
  - `A.*`: Selects all columns from the subquery `A`, which includes `product_id` and calculated revenue.
- **Subquery (A)**:
  - **Inner Query**:
    - `SELECT product_id, SUM((cost_in_dollars) * units_sold) AS revenue`: Calculates total revenue for each product by multiplying `cost_in_dollars` by `units_sold` and summing the results.
    - `FROM online_orders`: Data is sourced from the `online_orders` table.
    - `WHERE date BETWEEN '2022-01-01' AND '2022-06-30'`: Filters records to include only those between January 1, 2022, and June 30, 2022.
    - `GROUP BY product_id`: Groups the results by `product_id` to aggregate revenue for each product.
- **Outer Query**:
  - `ORDER BY revenue DESC`: Orders the products by revenue in descending order, so the highest revenue products appear first.
  - `LIMIT 5`: Restricts the output to the top 5 products with the highest revenue.
